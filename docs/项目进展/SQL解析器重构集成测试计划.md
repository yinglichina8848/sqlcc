# SQL解析器重构集成与测试计划

## 概述
本计划旨在将SQL Parser重构组件完全集成到SQLCC核心系统中，并建立完整的测试体系，确保重构后的新Parser能够完全替代旧Parser。

## 重构组件状态
✅ `parser_new.cpp` - 新的递归下降解析器，支持完整的SQL语法  
✅ `lexer_new.cpp` - DFA状态机词法分析器  
✅ `token_new.cpp` - 新的Token类型系统  
✅ 现代AST架构（智能指针、访问者模式、位置追踪）

## 集成测试计划

### 阶段1：测试迁移与重构 ✅ 进行中
- [x] 分析现有测试框架
- [ ] 1.1 停止旧Parser测试
- [ ] 1.2 创建新Parser测试

### 阶段2：集成测试开发 ⏳ 待开始
- [ ] 2.1 基本功能集成测试
- [ ] 2.2 SQL语法覆盖测试

### 阶段3：性能与回归测试 ⏳ 待开始
- [ ] 3.1 性能基准测试
- [ ] 3.2 回归测试

### 阶段4：测试框架集成 ⏳ 待开始
- [ ] 4.1 CMake集成
- [ ] 4.2 测试脚本更新

### 阶段5：验证与优化 ⏳ 待开始
- [ ] 5.1 功能验证
- [ ] 5.2 文档更新

## 关键要求
1. **目录整洁**: 所有测试编译在专用目录，不污染主目录
2. **渐进迁移**: 逐步停用旧测试，启用新测试
3. **依赖管理**: 确保新测试只依赖重构后的组件
4. **错误隔离**: 新Parser测试与旧系统完全隔离

## 测试覆盖率目标
- 单元测试: >90% 新Parser代码覆盖
- 集成测试: 100% SQL语法支持验证
- 性能测试: 解析速度提升>2x（相对旧Parser）

---
**创建时间**: 2025-12-04  
**状态**: 阶段1进行中
