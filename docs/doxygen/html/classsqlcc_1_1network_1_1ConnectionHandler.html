<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SQLCC: sqlcc::network::ConnectionHandler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SQLCC<span id="projectnumber">&#160;0.2.3</span>
   </div>
   <div id="projectbrief">Simple C++ Database Storage Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classsqlcc_1_1network_1_1ConnectionHandler.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classsqlcc_1_1network_1_1ConnectionHandler-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">sqlcc::network::ConnectionHandler Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="network_8h_source.html">network.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a95381631afb628f524b8ea2625f70e04" id="r_a95381631afb628f524b8ea2625f70e04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a95381631afb628f524b8ea2625f70e04">ConnectionHandler</a> (int fd, std::shared_ptr&lt; <a class="el" href="classsqlcc_1_1network_1_1SessionManager.html">SessionManager</a> &gt; session_manager, std::shared_ptr&lt; <a class="el" href="classsqlcc_1_1SqlExecutor.html">sqlcc::SqlExecutor</a> &gt; sql_executor)</td></tr>
<tr class="separator:a95381631afb628f524b8ea2625f70e04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73918eac18dff83333a95210c494fe7c" id="r_a73918eac18dff83333a95210c494fe7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a73918eac18dff83333a95210c494fe7c">~ConnectionHandler</a> ()</td></tr>
<tr class="separator:a73918eac18dff83333a95210c494fe7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5cfb97f4898e1b7f74d0de2840a85ce" id="r_ac5cfb97f4898e1b7f74d0de2840a85ce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#ac5cfb97f4898e1b7f74d0de2840a85ce">GetFd</a> () const</td></tr>
<tr class="separator:ac5cfb97f4898e1b7f74d0de2840a85ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf9836e28bd586427be2b63caad9aa8a" id="r_abf9836e28bd586427be2b63caad9aa8a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abf9836e28bd586427be2b63caad9aa8a">IsClosed</a> () const</td></tr>
<tr class="separator:abf9836e28bd586427be2b63caad9aa8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ac70f4affd6baa8792bf6aaab1dfbf" id="r_a94ac70f4affd6baa8792bf6aaab1dfbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a94ac70f4affd6baa8792bf6aaab1dfbf">HandleEvent</a> (uint32_t events)</td></tr>
<tr class="separator:a94ac70f4affd6baa8792bf6aaab1dfbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4b0b31a2a3a99fc43ad1180e5fcb84f" id="r_ab4b0b31a2a3a99fc43ad1180e5fcb84f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#ab4b0b31a2a3a99fc43ad1180e5fcb84f">ProcessMessage</a> (const std::vector&lt; char &gt; &amp;data)</td></tr>
<tr class="separator:ab4b0b31a2a3a99fc43ad1180e5fcb84f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab69677ac35a985b7202a9816e574a95e" id="r_ab69677ac35a985b7202a9816e574a95e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#ab69677ac35a985b7202a9816e574a95e">HandleRead</a> ()</td></tr>
<tr class="separator:ab69677ac35a985b7202a9816e574a95e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c731b6dce5709ce8d4c167e2f6914e7" id="r_a5c731b6dce5709ce8d4c167e2f6914e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a5c731b6dce5709ce8d4c167e2f6914e7">HandleWrite</a> ()</td></tr>
<tr class="separator:a5c731b6dce5709ce8d4c167e2f6914e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015adb2553b6453cf6504fd4f4f5fa1c" id="r_a015adb2553b6453cf6504fd4f4f5fa1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a015adb2553b6453cf6504fd4f4f5fa1c">SendMessage</a> (const std::vector&lt; char &gt; &amp;message)</td></tr>
<tr class="separator:a015adb2553b6453cf6504fd4f4f5fa1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24b89f3fb154d1f5f35ebbba15dd0b13" id="r_a24b89f3fb154d1f5f35ebbba15dd0b13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a24b89f3fb154d1f5f35ebbba15dd0b13">Close</a> ()</td></tr>
<tr class="separator:a24b89f3fb154d1f5f35ebbba15dd0b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf10658d8dadc73e66a45782f4de0f40" id="r_aaf10658d8dadc73e66a45782f4de0f40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aaf10658d8dadc73e66a45782f4de0f40">HandleConnectMessage</a> (const std::vector&lt; char &gt; &amp;data)</td></tr>
<tr class="separator:aaf10658d8dadc73e66a45782f4de0f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2838025dcb831ce124988079bb3bd101" id="r_a2838025dcb831ce124988079bb3bd101"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a2838025dcb831ce124988079bb3bd101">HandleAuthMessage</a> (const std::vector&lt; char &gt; &amp;data)</td></tr>
<tr class="separator:a2838025dcb831ce124988079bb3bd101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a850c0a5d231adb34578786865f39dcc0" id="r_a850c0a5d231adb34578786865f39dcc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a850c0a5d231adb34578786865f39dcc0">HandleQueryMessage</a> (const std::vector&lt; char &gt; &amp;data)</td></tr>
<tr class="separator:a850c0a5d231adb34578786865f39dcc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5527d9ba38b09712f340e49766d833b0" id="r_a5527d9ba38b09712f340e49766d833b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a5527d9ba38b09712f340e49766d833b0">HandleKeyExchangeMessage</a> (const std::vector&lt; char &gt; &amp;data)</td></tr>
<tr class="separator:a5527d9ba38b09712f340e49766d833b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac602f08af112725cb71fa8ae2330482" id="r_aac602f08af112725cb71fa8ae2330482"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aac602f08af112725cb71fa8ae2330482">SendErrorMessage</a> (const std::string &amp;error)</td></tr>
<tr class="separator:aac602f08af112725cb71fa8ae2330482"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0c0ac8837ca47b8333ba05ed8be19d2d" id="r_a0c0ac8837ca47b8333ba05ed8be19d2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a></td></tr>
<tr class="separator:a0c0ac8837ca47b8333ba05ed8be19d2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc9f57768bd31487fd70a93433fed8f" id="r_a4bc9f57768bd31487fd70a93433fed8f"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classsqlcc_1_1network_1_1SessionManager.html">SessionManager</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a4bc9f57768bd31487fd70a93433fed8f">session_manager_</a></td></tr>
<tr class="separator:a4bc9f57768bd31487fd70a93433fed8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafbcdfdd4ef0d522ee4cfe698f473ac1" id="r_aafbcdfdd4ef0d522ee4cfe698f473ac1"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classsqlcc_1_1SqlExecutor.html">sqlcc::SqlExecutor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aafbcdfdd4ef0d522ee4cfe698f473ac1">sql_executor_</a></td></tr>
<tr class="separator:aafbcdfdd4ef0d522ee4cfe698f473ac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba44ef826548143ee0a2bc1d7154966" id="r_abba44ef826548143ee0a2bc1d7154966"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classsqlcc_1_1network_1_1Session.html">Session</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a></td></tr>
<tr class="separator:abba44ef826548143ee0a2bc1d7154966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a209a0ecc167cb5aae86820fea9bd4ebf" id="r_a209a0ecc167cb5aae86820fea9bd4ebf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a209a0ecc167cb5aae86820fea9bd4ebf">closed_</a></td></tr>
<tr class="separator:a209a0ecc167cb5aae86820fea9bd4ebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f467ddb730965d1a663242bd6a1e17a" id="r_a3f467ddb730965d1a663242bd6a1e17a"><td class="memItemLeft" align="right" valign="top">std::queue&lt; std::vector&lt; char &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a3f467ddb730965d1a663242bd6a1e17a">write_queue_</a></td></tr>
<tr class="separator:a3f467ddb730965d1a663242bd6a1e17a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34319e10eba112051220f8747e53dd34" id="r_a34319e10eba112051220f8747e53dd34"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a34319e10eba112051220f8747e53dd34">write_mutex_</a></td></tr>
<tr class="separator:a34319e10eba112051220f8747e53dd34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00132">132</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a95381631afb628f524b8ea2625f70e04" name="a95381631afb628f524b8ea2625f70e04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95381631afb628f524b8ea2625f70e04">&#9670;&#160;</a></span>ConnectionHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sqlcc::network::ConnectionHandler::ConnectionHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classsqlcc_1_1network_1_1SessionManager.html">SessionManager</a> &gt;&#160;</td>
          <td class="paramname"><em>session_manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classsqlcc_1_1SqlExecutor.html">sqlcc::SqlExecutor</a> &gt;&#160;</td>
          <td class="paramname"><em>sql_executor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00258">258</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  259</span>    : <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a>(fd), <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a4bc9f57768bd31487fd70a93433fed8f">session_manager_</a>(std::move(session_manager)), <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aafbcdfdd4ef0d522ee4cfe698f473ac1">sql_executor_</a>(std::move(sql_executor)), </div>
<div class="line"><span class="lineno">  260</span>      <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a209a0ecc167cb5aae86820fea9bd4ebf">closed_</a>(<span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  261</span><span class="preprocessor">#ifdef __linux__</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="comment">// 设置为非阻塞模式</span></div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordtype">int</span> flags = fcntl(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a>, F_GETFL, 0);</div>
<div class="line"><span class="lineno">  264</span>    fcntl(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a>, F_SETFL, flags | O_NONBLOCK);</div>
<div class="line"><span class="lineno">  265</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  266</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a0c0ac8837ca47b8333ba05ed8be19d2d"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">sqlcc::network::ConnectionHandler::fd_</a></div><div class="ttdeci">int fd_</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00154">network.h:154</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a209a0ecc167cb5aae86820fea9bd4ebf"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a209a0ecc167cb5aae86820fea9bd4ebf">sqlcc::network::ConnectionHandler::closed_</a></div><div class="ttdeci">bool closed_</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00158">network.h:158</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a4bc9f57768bd31487fd70a93433fed8f"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a4bc9f57768bd31487fd70a93433fed8f">sqlcc::network::ConnectionHandler::session_manager_</a></div><div class="ttdeci">std::shared_ptr&lt; SessionManager &gt; session_manager_</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00155">network.h:155</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_aafbcdfdd4ef0d522ee4cfe698f473ac1"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#aafbcdfdd4ef0d522ee4cfe698f473ac1">sqlcc::network::ConnectionHandler::sql_executor_</a></div><div class="ttdeci">std::shared_ptr&lt; sqlcc::SqlExecutor &gt; sql_executor_</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00156">network.h:156</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_abba44ef826548143ee0a2bc1d7154966"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">sqlcc::network::ConnectionHandler::session_</a></div><div class="ttdeci">std::shared_ptr&lt; Session &gt; session_</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00157">network.h:157</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00154">fd_</a>.</p>

</div>
</div>
<a id="a73918eac18dff83333a95210c494fe7c" name="a73918eac18dff83333a95210c494fe7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73918eac18dff83333a95210c494fe7c">&#9670;&#160;</a></span>~ConnectionHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sqlcc::network::ConnectionHandler::~ConnectionHandler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00268">268</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  268</span>                                      {</div>
<div class="line"><span class="lineno">  269</span>    <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a24b89f3fb154d1f5f35ebbba15dd0b13">Close</a>();</div>
<div class="line"><span class="lineno">  270</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a24b89f3fb154d1f5f35ebbba15dd0b13"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a24b89f3fb154d1f5f35ebbba15dd0b13">sqlcc::network::ConnectionHandler::Close</a></div><div class="ttdeci">void Close()</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00352">network.cpp:352</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8cpp_source.html#l00352">Close()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a24b89f3fb154d1f5f35ebbba15dd0b13" name="a24b89f3fb154d1f5f35ebbba15dd0b13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24b89f3fb154d1f5f35ebbba15dd0b13">&#9670;&#160;</a></span>Close()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::Close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00352">352</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  352</span>                              {</div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a209a0ecc167cb5aae86820fea9bd4ebf">closed_</a>) {</div>
<div class="line"><span class="lineno">  354</span>        <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a209a0ecc167cb5aae86820fea9bd4ebf">closed_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  355</span><span class="preprocessor">#ifdef __linux__</span></div>
<div class="line"><span class="lineno">  356</span>        close(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a>);</div>
<div class="line"><span class="lineno">  357</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  358</span>    }</div>
<div class="line"><span class="lineno">  359</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00158">closed_</a>, and <a class="el" href="network_8h_source.html#l00154">fd_</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00280">HandleEvent()</a>, <a class="el" href="network_8cpp_source.html#l00294">HandleRead()</a>, <a class="el" href="network_8cpp_source.html#l00315">HandleWrite()</a>, and <a class="el" href="network_8cpp_source.html#l00268">~ConnectionHandler()</a>.</p>

</div>
</div>
<a id="ac5cfb97f4898e1b7f74d0de2840a85ce" name="ac5cfb97f4898e1b7f74d0de2840a85ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5cfb97f4898e1b7f74d0de2840a85ce">&#9670;&#160;</a></span>GetFd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sqlcc::network::ConnectionHandler::GetFd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00272">272</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  272</span>                                   {</div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a>;</div>
<div class="line"><span class="lineno">  274</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00154">fd_</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00653">sqlcc::network::ServerNetworkManager::ProcessEvents()</a>.</p>

</div>
</div>
<a id="a2838025dcb831ce124988079bb3bd101" name="a2838025dcb831ce124988079bb3bd101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2838025dcb831ce124988079bb3bd101">&#9670;&#160;</a></span>HandleAuthMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::HandleAuthMessage </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00430">430</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  430</span>                                                                     {</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">if</span> (data.size() &lt; <span class="keyword">sizeof</span>(MessageHeader)) {</div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  433</span>    }</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>    MessageHeader* header = <span class="keyword">reinterpret_cast&lt;</span>MessageHeader*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(data.data()));</div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordflow">if</span> (data.size() &lt; <span class="keyword">sizeof</span>(MessageHeader) + header-&gt;length) {</div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  438</span>    }</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>    <span class="comment">// 解析新的认证数据格式</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="comment">// 格式: [uint32_t username_len][uint32_t password_len][username][password]</span></div>
<div class="line"><span class="lineno">  442</span>    <span class="keyword">const</span> <span class="keywordtype">char</span>* body = data.data() + <span class="keyword">sizeof</span>(MessageHeader);</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">if</span> (header-&gt;length &lt; 2 * <span class="keyword">sizeof</span>(uint32_t)) {</div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  445</span>    }</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    uint32_t username_len = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>uint32_t*<span class="keyword">&gt;</span>(body);</div>
<div class="line"><span class="lineno">  448</span>    uint32_t password_len = *<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>uint32_t*<span class="keyword">&gt;</span>(body + <span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><span class="lineno">  449</span>    </div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">if</span> (header-&gt;length != 2 * <span class="keyword">sizeof</span>(uint32_t) + username_len + password_len) {</div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  452</span>    }</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    std::string username(body + 2 * <span class="keyword">sizeof</span>(uint32_t), username_len);</div>
<div class="line"><span class="lineno">  455</span>    std::string password(body + 2 * <span class="keyword">sizeof</span>(uint32_t) + username_len, password_len);</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordtype">bool</span> authenticated = <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a4bc9f57768bd31487fd70a93433fed8f">session_manager_</a>-&gt;Authenticate(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>-&gt;GetSessionId(), username, password);</div>
<div class="line"><span class="lineno">  458</span>    </div>
<div class="line"><span class="lineno">  459</span>    <span class="comment">// 发送认证确认消息</span></div>
<div class="line"><span class="lineno">  460</span>    MessageHeader ack_header;</div>
<div class="line"><span class="lineno">  461</span>    ack_header.magic = 0x53514C43; <span class="comment">// &#39;SQLC&#39;</span></div>
<div class="line"><span class="lineno">  462</span>    ack_header.length = 0;</div>
<div class="line"><span class="lineno">  463</span>    ack_header.type = <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a921afb52cfa480007166b218dcf3e0c4">AUTH_ACK</a>;</div>
<div class="line"><span class="lineno">  464</span>    ack_header.flags = authenticated ? 0 : 1; <span class="comment">// 使用flags表示认证结果</span></div>
<div class="line"><span class="lineno">  465</span>    ack_header.sequence_id = header-&gt;sequence_id;</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    std::vector&lt;char&gt; ack_msg(<span class="keyword">sizeof</span>(MessageHeader));</div>
<div class="line"><span class="lineno">  468</span>    std::memcpy(ack_msg.data(), &amp;ack_header, <span class="keyword">sizeof</span>(MessageHeader));</div>
<div class="line"><span class="lineno">  469</span>    <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a015adb2553b6453cf6504fd4f4f5fa1c">SendMessage</a>(ack_msg);</div>
<div class="line"><span class="lineno">  470</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a015adb2553b6453cf6504fd4f4f5fa1c"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a015adb2553b6453cf6504fd4f4f5fa1c">sqlcc::network::ConnectionHandler::SendMessage</a></div><div class="ttdeci">void SendMessage(const std::vector&lt; char &gt; &amp;message)</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00340">network.cpp:340</a></div></div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50a921afb52cfa480007166b218dcf3e0c4"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a921afb52cfa480007166b218dcf3e0c4">sqlcc::network::AUTH_ACK</a></div><div class="ttdeci">@ AUTH_ACK</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00028">network.h:28</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00028">sqlcc::network::AUTH_ACK</a>, <a class="el" href="network_8h_source.html#l00042">sqlcc::network::MessageHeader::flags</a>, <a class="el" href="network_8h_source.html#l00040">sqlcc::network::MessageHeader::length</a>, <a class="el" href="network_8h_source.html#l00039">sqlcc::network::MessageHeader::magic</a>, <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>, <a class="el" href="network_8h_source.html#l00043">sqlcc::network::MessageHeader::sequence_id</a>, <a class="el" href="network_8h_source.html#l00157">session_</a>, <a class="el" href="network_8h_source.html#l00155">session_manager_</a>, and <a class="el" href="network_8h_source.html#l00041">sqlcc::network::MessageHeader::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00361">ProcessMessage()</a>.</p>

</div>
</div>
<a id="aaf10658d8dadc73e66a45782f4de0f40" name="aaf10658d8dadc73e66a45782f4de0f40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf10658d8dadc73e66a45782f4de0f40">&#9670;&#160;</a></span>HandleConnectMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::HandleConnectMessage </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00394">394</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  394</span>                                                                        {</div>
<div class="line"><span class="lineno">  395</span>    <span class="comment">// 创建会话</span></div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a> = <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a4bc9f57768bd31487fd70a93433fed8f">session_manager_</a>-&gt;CreateSession();</div>
<div class="line"><span class="lineno">  397</span>    </div>
<div class="line"><span class="lineno">  398</span>    <span class="comment">// 检查客户端连接消息中的标志</span></div>
<div class="line"><span class="lineno">  399</span>    uint32_t client_flags = 0;</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">if</span> (data.size() &gt;= <span class="keyword">sizeof</span>(MessageHeader)) {</div>
<div class="line"><span class="lineno">  401</span>        MessageHeader* header = <span class="keyword">reinterpret_cast&lt;</span>MessageHeader*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(data.data()));</div>
<div class="line"><span class="lineno">  402</span>        client_flags = header-&gt;flags;</div>
<div class="line"><span class="lineno">  403</span>        </div>
<div class="line"><span class="lineno">  404</span>        <span class="comment">// 如果客户端请求禁用加密，记录到会话中</span></div>
<div class="line"><span class="lineno">  405</span>        <span class="keywordflow">if</span> (client_flags &amp; 0x01) {</div>
<div class="line"><span class="lineno">  406</span>            <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>-&gt;SetEncryptionDisabled(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  407</span>        }</div>
<div class="line"><span class="lineno">  408</span>        </div>
<div class="line"><span class="lineno">  409</span>        <span class="comment">// 如果客户端请求禁用认证，记录到会话中</span></div>
<div class="line"><span class="lineno">  410</span>        <span class="keywordflow">if</span> (client_flags &amp; 0x02) {</div>
<div class="line"><span class="lineno">  411</span>            <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>-&gt;SetAuthenticationDisabled(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  412</span>            <span class="comment">// 自动通过认证</span></div>
<div class="line"><span class="lineno">  413</span>            <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>-&gt;SetAuthenticated(<span class="stringliteral">&quot;anonymous&quot;</span>);</div>
<div class="line"><span class="lineno">  414</span>        }</div>
<div class="line"><span class="lineno">  415</span>    }</div>
<div class="line"><span class="lineno">  416</span>    </div>
<div class="line"><span class="lineno">  417</span>    <span class="comment">// 发送连接确认消息，包含相同的标志</span></div>
<div class="line"><span class="lineno">  418</span>    MessageHeader ack_header;</div>
<div class="line"><span class="lineno">  419</span>    ack_header.magic = 0x53514C43; <span class="comment">// &#39;SQLC&#39;</span></div>
<div class="line"><span class="lineno">  420</span>    ack_header.length = 0;</div>
<div class="line"><span class="lineno">  421</span>    ack_header.type = <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a77e0192343a29731c5860f2c53498620">CONN_ACK</a>;</div>
<div class="line"><span class="lineno">  422</span>    ack_header.flags = client_flags; <span class="comment">// 回显客户端的标志</span></div>
<div class="line"><span class="lineno">  423</span>    ack_header.sequence_id = 1;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    std::vector&lt;char&gt; ack_msg(<span class="keyword">sizeof</span>(MessageHeader));</div>
<div class="line"><span class="lineno">  426</span>    std::memcpy(ack_msg.data(), &amp;ack_header, <span class="keyword">sizeof</span>(MessageHeader));</div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a015adb2553b6453cf6504fd4f4f5fa1c">SendMessage</a>(ack_msg);</div>
<div class="line"><span class="lineno">  428</span>}</div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50a77e0192343a29731c5860f2c53498620"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a77e0192343a29731c5860f2c53498620">sqlcc::network::CONN_ACK</a></div><div class="ttdeci">@ CONN_ACK</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00026">network.h:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00026">sqlcc::network::CONN_ACK</a>, <a class="el" href="network_8h_source.html#l00042">sqlcc::network::MessageHeader::flags</a>, <a class="el" href="network_8h_source.html#l00040">sqlcc::network::MessageHeader::length</a>, <a class="el" href="network_8h_source.html#l00039">sqlcc::network::MessageHeader::magic</a>, <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>, <a class="el" href="network_8h_source.html#l00043">sqlcc::network::MessageHeader::sequence_id</a>, <a class="el" href="network_8h_source.html#l00157">session_</a>, <a class="el" href="network_8h_source.html#l00155">session_manager_</a>, and <a class="el" href="network_8h_source.html#l00041">sqlcc::network::MessageHeader::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00361">ProcessMessage()</a>.</p>

</div>
</div>
<a id="a94ac70f4affd6baa8792bf6aaab1dfbf" name="a94ac70f4affd6baa8792bf6aaab1dfbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ac70f4affd6baa8792bf6aaab1dfbf">&#9670;&#160;</a></span>HandleEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::HandleEvent </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>events</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00280">280</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  280</span>                                                   {</div>
<div class="line"><span class="lineno">  281</span><span class="preprocessor">#ifdef __linux__</span></div>
<div class="line"><span class="lineno">  282</span>    <span class="keywordflow">if</span> (events &amp; EPOLLIN) {</div>
<div class="line"><span class="lineno">  283</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#ab69677ac35a985b7202a9816e574a95e">HandleRead</a>();</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">if</span> (events &amp; EPOLLOUT) {</div>
<div class="line"><span class="lineno">  286</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a5c731b6dce5709ce8d4c167e2f6914e7">HandleWrite</a>();</div>
<div class="line"><span class="lineno">  287</span>    }</div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">if</span> (events &amp; (EPOLLERR | EPOLLHUP)) {</div>
<div class="line"><span class="lineno">  289</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a24b89f3fb154d1f5f35ebbba15dd0b13">Close</a>();</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  292</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a5c731b6dce5709ce8d4c167e2f6914e7"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a5c731b6dce5709ce8d4c167e2f6914e7">sqlcc::network::ConnectionHandler::HandleWrite</a></div><div class="ttdeci">void HandleWrite()</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00315">network.cpp:315</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_ab69677ac35a985b7202a9816e574a95e"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#ab69677ac35a985b7202a9816e574a95e">sqlcc::network::ConnectionHandler::HandleRead</a></div><div class="ttdeci">void HandleRead()</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00294">network.cpp:294</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8cpp_source.html#l00352">Close()</a>, <a class="el" href="network_8cpp_source.html#l00294">HandleRead()</a>, and <a class="el" href="network_8cpp_source.html#l00315">HandleWrite()</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00653">sqlcc::network::ServerNetworkManager::ProcessEvents()</a>.</p>

</div>
</div>
<a id="a5527d9ba38b09712f340e49766d833b0" name="a5527d9ba38b09712f340e49766d833b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5527d9ba38b09712f340e49766d833b0">&#9670;&#160;</a></span>HandleKeyExchangeMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::HandleKeyExchangeMessage </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00531">531</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  531</span>                                                                            {</div>
<div class="line"><span class="lineno">  532</span>    <span class="comment">// 处理密钥交换消息</span></div>
<div class="line"><span class="lineno">  533</span>    MessageHeader* header = <span class="keyword">reinterpret_cast&lt;</span>MessageHeader*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(data.data()));</div>
<div class="line"><span class="lineno">  534</span>    </div>
<div class="line"><span class="lineno">  535</span>    <span class="comment">// 构造密钥交换确认消息</span></div>
<div class="line"><span class="lineno">  536</span>    std::string ack_data = <span class="stringliteral">&quot;Key exchange completed&quot;</span>;</div>
<div class="line"><span class="lineno">  537</span>    </div>
<div class="line"><span class="lineno">  538</span>    MessageHeader ack_header;</div>
<div class="line"><span class="lineno">  539</span>    ack_header.magic = 0x53514C43; <span class="comment">// &#39;SQLC&#39;</span></div>
<div class="line"><span class="lineno">  540</span>    ack_header.length = ack_data.length();</div>
<div class="line"><span class="lineno">  541</span>    ack_header.type = <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50ad54bc8610944fbc298f166a346613818">KEY_EXCHANGE_ACK</a>;</div>
<div class="line"><span class="lineno">  542</span>    ack_header.flags = 0;</div>
<div class="line"><span class="lineno">  543</span>    ack_header.sequence_id = header-&gt;sequence_id;</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    std::vector&lt;char&gt; ack_msg(<span class="keyword">sizeof</span>(MessageHeader) + ack_data.length());</div>
<div class="line"><span class="lineno">  546</span>    std::memcpy(ack_msg.data(), &amp;ack_header, <span class="keyword">sizeof</span>(MessageHeader));</div>
<div class="line"><span class="lineno">  547</span>    std::memcpy(ack_msg.data() + <span class="keyword">sizeof</span>(MessageHeader), ack_data.c_str(), ack_data.length());</div>
<div class="line"><span class="lineno">  548</span>    <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a015adb2553b6453cf6504fd4f4f5fa1c">SendMessage</a>(ack_msg);</div>
<div class="line"><span class="lineno">  549</span>}</div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50ad54bc8610944fbc298f166a346613818"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50ad54bc8610944fbc298f166a346613818">sqlcc::network::KEY_EXCHANGE_ACK</a></div><div class="ttdeci">@ KEY_EXCHANGE_ACK</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00035">network.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00042">sqlcc::network::MessageHeader::flags</a>, <a class="el" href="network_8h_source.html#l00034">sqlcc::network::KEY_EXCHANGE_ACK</a>, <a class="el" href="network_8h_source.html#l00040">sqlcc::network::MessageHeader::length</a>, <a class="el" href="network_8h_source.html#l00039">sqlcc::network::MessageHeader::magic</a>, <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>, <a class="el" href="network_8h_source.html#l00043">sqlcc::network::MessageHeader::sequence_id</a>, and <a class="el" href="network_8h_source.html#l00041">sqlcc::network::MessageHeader::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00361">ProcessMessage()</a>.</p>

</div>
</div>
<a id="a850c0a5d231adb34578786865f39dcc0" name="a850c0a5d231adb34578786865f39dcc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a850c0a5d231adb34578786865f39dcc0">&#9670;&#160;</a></span>HandleQueryMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::HandleQueryMessage </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00472">472</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  472</span>                                                                      {</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>) {</div>
<div class="line"><span class="lineno">  474</span>        <span class="comment">// 会话不存在</span></div>
<div class="line"><span class="lineno">  475</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aac602f08af112725cb71fa8ae2330482">SendErrorMessage</a>(<span class="stringliteral">&quot;Session not found&quot;</span>);</div>
<div class="line"><span class="lineno">  476</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  477</span>    }</div>
<div class="line"><span class="lineno">  478</span>    </div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">// 检查是否需要认证（只有在未禁用认证的情况下才要求认证）</span></div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>-&gt;IsAuthenticationDisabled() &amp;&amp; !<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#abba44ef826548143ee0a2bc1d7154966">session_</a>-&gt;IsAuthenticated()) {</div>
<div class="line"><span class="lineno">  481</span>        <span class="comment">// 未禁用认证但用户未认证，拒绝请求</span></div>
<div class="line"><span class="lineno">  482</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aac602f08af112725cb71fa8ae2330482">SendErrorMessage</a>(<span class="stringliteral">&quot;Not authenticated&quot;</span>);</div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  484</span>    }</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    MessageHeader* header = <span class="keyword">reinterpret_cast&lt;</span>MessageHeader*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(data.data()));</div>
<div class="line"><span class="lineno">  487</span>    </div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">// 确保有足够的数据</span></div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">if</span> (data.size() &lt; <span class="keyword">sizeof</span>(MessageHeader) + header-&gt;length) {</div>
<div class="line"><span class="lineno">  490</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aac602f08af112725cb71fa8ae2330482">SendErrorMessage</a>(<span class="stringliteral">&quot;Invalid query message&quot;</span>);</div>
<div class="line"><span class="lineno">  491</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  492</span>    }</div>
<div class="line"><span class="lineno">  493</span>    </div>
<div class="line"><span class="lineno">  494</span>    <span class="comment">// 获取查询语句</span></div>
<div class="line"><span class="lineno">  495</span>    std::string query(data.data() + <span class="keyword">sizeof</span>(MessageHeader), header-&gt;length);</div>
<div class="line"><span class="lineno">  496</span>    </div>
<div class="line"><span class="lineno">  497</span>    <span class="comment">// 执行SQL查询</span></div>
<div class="line"><span class="lineno">  498</span>    std::string result;</div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordtype">bool</span> success = <span class="keyword">true</span>;  <span class="comment">// 默认成功，只有发生错误时设为false</span></div>
<div class="line"><span class="lineno">  500</span>    </div>
<div class="line"><span class="lineno">  501</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aafbcdfdd4ef0d522ee4cfe698f473ac1">sql_executor_</a>) {</div>
<div class="line"><span class="lineno">  502</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  503</span>            result = <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aafbcdfdd4ef0d522ee4cfe698f473ac1">sql_executor_</a>-&gt;Execute(query);</div>
<div class="line"><span class="lineno">  504</span>            <span class="comment">// 检查执行结果是否表示错误</span></div>
<div class="line"><span class="lineno">  505</span>            <span class="keywordflow">if</span> (result.find(<span class="stringliteral">&quot;ERROR:&quot;</span>) == 0 || result.find(<span class="stringliteral">&quot;Error:&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  506</span>                success = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  507</span>            }</div>
<div class="line"><span class="lineno">  508</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  509</span>            result = <span class="stringliteral">&quot;Exception: &quot;</span> + std::string(e.what());</div>
<div class="line"><span class="lineno">  510</span>            success = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  511</span>        }</div>
<div class="line"><span class="lineno">  512</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  513</span>        result = <span class="stringliteral">&quot;SQL executor not initialized&quot;</span>;</div>
<div class="line"><span class="lineno">  514</span>        success = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="line"><span class="lineno">  516</span>    </div>
<div class="line"><span class="lineno">  517</span>    <span class="comment">// 构造查询结果消息</span></div>
<div class="line"><span class="lineno">  518</span>    MessageHeader result_header;</div>
<div class="line"><span class="lineno">  519</span>    result_header.magic = 0x53514C43; <span class="comment">// &#39;SQLC&#39;</span></div>
<div class="line"><span class="lineno">  520</span>    result_header.length = result.length();</div>
<div class="line"><span class="lineno">  521</span>    result_header.type = <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50abce56c97eeb645063cbcc165999dde97">QUERY_RESULT</a>;</div>
<div class="line"><span class="lineno">  522</span>    result_header.flags = success ? 0 : 1; <span class="comment">// 使用flags表示执行结果</span></div>
<div class="line"><span class="lineno">  523</span>    result_header.sequence_id = header-&gt;sequence_id;</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    std::vector&lt;char&gt; result_msg(<span class="keyword">sizeof</span>(MessageHeader) + result.length());</div>
<div class="line"><span class="lineno">  526</span>    std::memcpy(result_msg.data(), &amp;result_header, <span class="keyword">sizeof</span>(MessageHeader));</div>
<div class="line"><span class="lineno">  527</span>    std::memcpy(result_msg.data() + <span class="keyword">sizeof</span>(MessageHeader), result.c_str(), result.length());</div>
<div class="line"><span class="lineno">  528</span>    <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a015adb2553b6453cf6504fd4f4f5fa1c">SendMessage</a>(result_msg);</div>
<div class="line"><span class="lineno">  529</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_aac602f08af112725cb71fa8ae2330482"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#aac602f08af112725cb71fa8ae2330482">sqlcc::network::ConnectionHandler::SendErrorMessage</a></div><div class="ttdeci">void SendErrorMessage(const std::string &amp;error)</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00551">network.cpp:551</a></div></div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50abce56c97eeb645063cbcc165999dde97"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50abce56c97eeb645063cbcc165999dde97">sqlcc::network::QUERY_RESULT</a></div><div class="ttdeci">@ QUERY_RESULT</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00030">network.h:30</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00042">sqlcc::network::MessageHeader::flags</a>, <a class="el" href="network_8h_source.html#l00040">sqlcc::network::MessageHeader::length</a>, <a class="el" href="network_8h_source.html#l00039">sqlcc::network::MessageHeader::magic</a>, <a class="el" href="network_8h_source.html#l00030">sqlcc::network::QUERY_RESULT</a>, <a class="el" href="network_8cpp_source.html#l00551">SendErrorMessage()</a>, <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>, <a class="el" href="network_8h_source.html#l00043">sqlcc::network::MessageHeader::sequence_id</a>, <a class="el" href="network_8h_source.html#l00157">session_</a>, <a class="el" href="network_8h_source.html#l00156">sql_executor_</a>, and <a class="el" href="network_8h_source.html#l00041">sqlcc::network::MessageHeader::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00361">ProcessMessage()</a>.</p>

</div>
</div>
<a id="ab69677ac35a985b7202a9816e574a95e" name="ab69677ac35a985b7202a9816e574a95e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab69677ac35a985b7202a9816e574a95e">&#9670;&#160;</a></span>HandleRead()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::HandleRead </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00294">294</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>                                   {</div>
<div class="line"><span class="lineno">  295</span><span class="preprocessor">#ifdef __linux__</span></div>
<div class="line"><span class="lineno">  296</span>    <span class="comment">// 读取数据并处理</span></div>
<div class="line"><span class="lineno">  297</span>    std::vector&lt;char&gt; buffer(4096);</div>
<div class="line"><span class="lineno">  298</span>    ssize_t bytes_read = recv(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a>, buffer.data(), buffer.size(), 0);</div>
<div class="line"><span class="lineno">  299</span>    </div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">if</span> (bytes_read &gt; 0) {</div>
<div class="line"><span class="lineno">  301</span>        buffer.resize(bytes_read);</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#ab4b0b31a2a3a99fc43ad1180e5fcb84f">ProcessMessage</a>(buffer);</div>
<div class="line"><span class="lineno">  303</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bytes_read == 0) {</div>
<div class="line"><span class="lineno">  304</span>        <span class="comment">// 客户端关闭连接</span></div>
<div class="line"><span class="lineno">  305</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a24b89f3fb154d1f5f35ebbba15dd0b13">Close</a>();</div>
<div class="line"><span class="lineno">  306</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  307</span>        <span class="comment">// 错误发生</span></div>
<div class="line"><span class="lineno">  308</span>        <span class="keywordflow">if</span> (errno != EAGAIN &amp;&amp; errno != EWOULDBLOCK) {</div>
<div class="line"><span class="lineno">  309</span>            <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a24b89f3fb154d1f5f35ebbba15dd0b13">Close</a>();</div>
<div class="line"><span class="lineno">  310</span>        }</div>
<div class="line"><span class="lineno">  311</span>    }</div>
<div class="line"><span class="lineno">  312</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  313</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_ab4b0b31a2a3a99fc43ad1180e5fcb84f"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#ab4b0b31a2a3a99fc43ad1180e5fcb84f">sqlcc::network::ConnectionHandler::ProcessMessage</a></div><div class="ttdeci">void ProcessMessage(const std::vector&lt; char &gt; &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00361">network.cpp:361</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8cpp_source.html#l00352">Close()</a>, <a class="el" href="network_8h_source.html#l00154">fd_</a>, and <a class="el" href="network_8cpp_source.html#l00361">ProcessMessage()</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00280">HandleEvent()</a>.</p>

</div>
</div>
<a id="a5c731b6dce5709ce8d4c167e2f6914e7" name="a5c731b6dce5709ce8d4c167e2f6914e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c731b6dce5709ce8d4c167e2f6914e7">&#9670;&#160;</a></span>HandleWrite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::HandleWrite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00315">315</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  315</span>                                    {</div>
<div class="line"><span class="lineno">  316</span><span class="preprocessor">#ifdef __linux__</span></div>
<div class="line"><span class="lineno">  317</span>    <span class="comment">// 处理写事件（如果有待发送的数据）</span></div>
<div class="line"><span class="lineno">  318</span>    std::lock_guard&lt;std::mutex&gt; lock(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a34319e10eba112051220f8747e53dd34">write_mutex_</a>);</div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">while</span> (!<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a3f467ddb730965d1a663242bd6a1e17a">write_queue_</a>.empty()) {</div>
<div class="line"><span class="lineno">  320</span>        <span class="keyword">const</span> std::vector&lt;char&gt;&amp; data = <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a3f467ddb730965d1a663242bd6a1e17a">write_queue_</a>.front();</div>
<div class="line"><span class="lineno">  321</span>        ssize_t bytes_sent = send(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a0c0ac8837ca47b8333ba05ed8be19d2d">fd_</a>, data.data(), data.size(), 0);</div>
<div class="line"><span class="lineno">  322</span>        </div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">if</span> (bytes_sent &gt; 0) {</div>
<div class="line"><span class="lineno">  324</span>            <span class="comment">// 成功发送数据</span></div>
<div class="line"><span class="lineno">  325</span>            <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a3f467ddb730965d1a663242bd6a1e17a">write_queue_</a>.pop();</div>
<div class="line"><span class="lineno">  326</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bytes_sent &lt; 0) {</div>
<div class="line"><span class="lineno">  327</span>            <span class="keywordflow">if</span> (errno == EAGAIN || errno == EWOULDBLOCK) {</div>
<div class="line"><span class="lineno">  328</span>                <span class="comment">// 发送缓冲区满，稍后重试</span></div>
<div class="line"><span class="lineno">  329</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  330</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  331</span>                <span class="comment">// 错误发生，关闭连接</span></div>
<div class="line"><span class="lineno">  332</span>                <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a24b89f3fb154d1f5f35ebbba15dd0b13">Close</a>();</div>
<div class="line"><span class="lineno">  333</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  334</span>            }</div>
<div class="line"><span class="lineno">  335</span>        }</div>
<div class="line"><span class="lineno">  336</span>    }</div>
<div class="line"><span class="lineno">  337</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  338</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a34319e10eba112051220f8747e53dd34"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a34319e10eba112051220f8747e53dd34">sqlcc::network::ConnectionHandler::write_mutex_</a></div><div class="ttdeci">std::mutex write_mutex_</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00160">network.h:160</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a3f467ddb730965d1a663242bd6a1e17a"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a3f467ddb730965d1a663242bd6a1e17a">sqlcc::network::ConnectionHandler::write_queue_</a></div><div class="ttdeci">std::queue&lt; std::vector&lt; char &gt; &gt; write_queue_</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00159">network.h:159</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8cpp_source.html#l00352">Close()</a>, <a class="el" href="network_8h_source.html#l00154">fd_</a>, <a class="el" href="network_8h_source.html#l00160">write_mutex_</a>, and <a class="el" href="network_8h_source.html#l00159">write_queue_</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00280">HandleEvent()</a>, and <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>.</p>

</div>
</div>
<a id="abf9836e28bd586427be2b63caad9aa8a" name="abf9836e28bd586427be2b63caad9aa8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf9836e28bd586427be2b63caad9aa8a">&#9670;&#160;</a></span>IsClosed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sqlcc::network::ConnectionHandler::IsClosed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00276">276</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  276</span>                                       {</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a209a0ecc167cb5aae86820fea9bd4ebf">closed_</a>;</div>
<div class="line"><span class="lineno">  278</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00158">closed_</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00653">sqlcc::network::ServerNetworkManager::ProcessEvents()</a>.</p>

</div>
</div>
<a id="ab4b0b31a2a3a99fc43ad1180e5fcb84f" name="ab4b0b31a2a3a99fc43ad1180e5fcb84f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b0b31a2a3a99fc43ad1180e5fcb84f">&#9670;&#160;</a></span>ProcessMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::ProcessMessage </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00361">361</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  361</span>                                                                  {</div>
<div class="line"><span class="lineno">  362</span>    <span class="comment">// 处理接收到的消息</span></div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordflow">if</span> (data.size() &lt; <span class="keyword">sizeof</span>(MessageHeader)) {</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  365</span>    }</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    MessageHeader* header = <span class="keyword">reinterpret_cast&lt;</span>MessageHeader*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(data.data()));</div>
<div class="line"><span class="lineno">  368</span>    </div>
<div class="line"><span class="lineno">  369</span>    <span class="comment">// 检查消息魔数</span></div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> (header-&gt;magic != 0x53514C43) { <span class="comment">// &#39;SQLC&#39;</span></div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  372</span>    }</div>
<div class="line"><span class="lineno">  373</span>    </div>
<div class="line"><span class="lineno">  374</span>    <span class="comment">// 根据消息类型处理</span></div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">switch</span> (header-&gt;type) {</div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50aff39ca287f61a5a744317d653dd35b25">CONNECT</a>:</div>
<div class="line"><span class="lineno">  377</span>            <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#aaf10658d8dadc73e66a45782f4de0f40">HandleConnectMessage</a>(data);</div>
<div class="line"><span class="lineno">  378</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  379</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a045bf25138ed3f04c60e1f4c5b8fa688">AUTH</a>:</div>
<div class="line"><span class="lineno">  380</span>            <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a2838025dcb831ce124988079bb3bd101">HandleAuthMessage</a>(data);</div>
<div class="line"><span class="lineno">  381</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50aa2dcca7438e72fbaf81f3e0084669d49">QUERY</a>:</div>
<div class="line"><span class="lineno">  383</span>            <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a850c0a5d231adb34578786865f39dcc0">HandleQueryMessage</a>(data);</div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a261e1233789ae88a4367c05cfb1ce237">KEY_EXCHANGE</a>:</div>
<div class="line"><span class="lineno">  386</span>            <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a5527d9ba38b09712f340e49766d833b0">HandleKeyExchangeMessage</a>(data);</div>
<div class="line"><span class="lineno">  387</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  389</span>            <span class="comment">// 未知消息类型</span></div>
<div class="line"><span class="lineno">  390</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  391</span>    }</div>
<div class="line"><span class="lineno">  392</span>}</div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a2838025dcb831ce124988079bb3bd101"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a2838025dcb831ce124988079bb3bd101">sqlcc::network::ConnectionHandler::HandleAuthMessage</a></div><div class="ttdeci">void HandleAuthMessage(const std::vector&lt; char &gt; &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00430">network.cpp:430</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a5527d9ba38b09712f340e49766d833b0"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a5527d9ba38b09712f340e49766d833b0">sqlcc::network::ConnectionHandler::HandleKeyExchangeMessage</a></div><div class="ttdeci">void HandleKeyExchangeMessage(const std::vector&lt; char &gt; &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00531">network.cpp:531</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_a850c0a5d231adb34578786865f39dcc0"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#a850c0a5d231adb34578786865f39dcc0">sqlcc::network::ConnectionHandler::HandleQueryMessage</a></div><div class="ttdeci">void HandleQueryMessage(const std::vector&lt; char &gt; &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00472">network.cpp:472</a></div></div>
<div class="ttc" id="aclasssqlcc_1_1network_1_1ConnectionHandler_html_aaf10658d8dadc73e66a45782f4de0f40"><div class="ttname"><a href="classsqlcc_1_1network_1_1ConnectionHandler.html#aaf10658d8dadc73e66a45782f4de0f40">sqlcc::network::ConnectionHandler::HandleConnectMessage</a></div><div class="ttdeci">void HandleConnectMessage(const std::vector&lt; char &gt; &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="network_8cpp_source.html#l00394">network.cpp:394</a></div></div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50a045bf25138ed3f04c60e1f4c5b8fa688"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a045bf25138ed3f04c60e1f4c5b8fa688">sqlcc::network::AUTH</a></div><div class="ttdeci">@ AUTH</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00027">network.h:27</a></div></div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50a261e1233789ae88a4367c05cfb1ce237"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a261e1233789ae88a4367c05cfb1ce237">sqlcc::network::KEY_EXCHANGE</a></div><div class="ttdeci">@ KEY_EXCHANGE</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00033">network.h:33</a></div></div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50aa2dcca7438e72fbaf81f3e0084669d49"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50aa2dcca7438e72fbaf81f3e0084669d49">sqlcc::network::QUERY</a></div><div class="ttdeci">@ QUERY</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00029">network.h:29</a></div></div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50aff39ca287f61a5a744317d653dd35b25"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50aff39ca287f61a5a744317d653dd35b25">sqlcc::network::CONNECT</a></div><div class="ttdeci">@ CONNECT</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00025">network.h:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00027">sqlcc::network::AUTH</a>, <a class="el" href="network_8h_source.html#l00025">sqlcc::network::CONNECT</a>, <a class="el" href="network_8cpp_source.html#l00430">HandleAuthMessage()</a>, <a class="el" href="network_8cpp_source.html#l00394">HandleConnectMessage()</a>, <a class="el" href="network_8cpp_source.html#l00531">HandleKeyExchangeMessage()</a>, <a class="el" href="network_8cpp_source.html#l00472">HandleQueryMessage()</a>, <a class="el" href="network_8h_source.html#l00033">sqlcc::network::KEY_EXCHANGE</a>, <a class="el" href="network_8h_source.html#l00039">sqlcc::network::MessageHeader::magic</a>, <a class="el" href="network_8h_source.html#l00029">sqlcc::network::QUERY</a>, and <a class="el" href="network_8h_source.html#l00041">sqlcc::network::MessageHeader::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00294">HandleRead()</a>.</p>

</div>
</div>
<a id="aac602f08af112725cb71fa8ae2330482" name="aac602f08af112725cb71fa8ae2330482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac602f08af112725cb71fa8ae2330482">&#9670;&#160;</a></span>SendErrorMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::SendErrorMessage </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>error</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00551">551</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  551</span>                                                               {</div>
<div class="line"><span class="lineno">  552</span>    MessageHeader error_header;</div>
<div class="line"><span class="lineno">  553</span>    error_header.magic = 0x53514C43; <span class="comment">// &#39;SQLC&#39;</span></div>
<div class="line"><span class="lineno">  554</span>    error_header.length = error.length();</div>
<div class="line"><span class="lineno">  555</span>    error_header.type = <a class="code hl_enumvalue" href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a665d78a57c4dbb5ed6afce63f1d07619">ERROR</a>;</div>
<div class="line"><span class="lineno">  556</span>    error_header.flags = 0;</div>
<div class="line"><span class="lineno">  557</span>    error_header.sequence_id = 0;</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    std::vector&lt;char&gt; error_msg(<span class="keyword">sizeof</span>(MessageHeader) + error.length());</div>
<div class="line"><span class="lineno">  560</span>    std::memcpy(error_msg.data(), &amp;error_header, <span class="keyword">sizeof</span>(MessageHeader));</div>
<div class="line"><span class="lineno">  561</span>    std::memcpy(error_msg.data() + <span class="keyword">sizeof</span>(MessageHeader), error.c_str(), error.length());</div>
<div class="line"><span class="lineno">  562</span>    <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a015adb2553b6453cf6504fd4f4f5fa1c">SendMessage</a>(error_msg);</div>
<div class="line"><span class="lineno">  563</span>}</div>
<div class="ttc" id="anamespacesqlcc_1_1network_html_ada45c98dee50190b8725b191d8bc8d50a665d78a57c4dbb5ed6afce63f1d07619"><div class="ttname"><a href="namespacesqlcc_1_1network.html#ada45c98dee50190b8725b191d8bc8d50a665d78a57c4dbb5ed6afce63f1d07619">sqlcc::network::ERROR</a></div><div class="ttdeci">@ ERROR</div><div class="ttdef"><b>Definition</b> <a href="network_8h_source.html#l00031">network.h:31</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00031">sqlcc::network::ERROR</a>, <a class="el" href="network_8h_source.html#l00042">sqlcc::network::MessageHeader::flags</a>, <a class="el" href="network_8h_source.html#l00040">sqlcc::network::MessageHeader::length</a>, <a class="el" href="network_8h_source.html#l00039">sqlcc::network::MessageHeader::magic</a>, <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>, <a class="el" href="network_8h_source.html#l00043">sqlcc::network::MessageHeader::sequence_id</a>, and <a class="el" href="network_8h_source.html#l00041">sqlcc::network::MessageHeader::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00472">HandleQueryMessage()</a>.</p>

</div>
</div>
<a id="a015adb2553b6453cf6504fd4f4f5fa1c" name="a015adb2553b6453cf6504fd4f4f5fa1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a015adb2553b6453cf6504fd4f4f5fa1c">&#9670;&#160;</a></span>SendMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sqlcc::network::ConnectionHandler::SendMessage </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00340">340</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  340</span>                                                                  {</div>
<div class="line"><span class="lineno">  341</span><span class="preprocessor">#ifdef __linux__</span></div>
<div class="line"><span class="lineno">  342</span>    std::lock_guard&lt;std::mutex&gt; lock(<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a34319e10eba112051220f8747e53dd34">write_mutex_</a>);</div>
<div class="line"><span class="lineno">  343</span>    <a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a3f467ddb730965d1a663242bd6a1e17a">write_queue_</a>.push(message);</div>
<div class="line"><span class="lineno">  344</span>    </div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">// 尝试立即发送</span></div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a3f467ddb730965d1a663242bd6a1e17a">write_queue_</a>.size() == 1) {</div>
<div class="line"><span class="lineno">  347</span>        <a class="code hl_function" href="classsqlcc_1_1network_1_1ConnectionHandler.html#a5c731b6dce5709ce8d4c167e2f6914e7">HandleWrite</a>();</div>
<div class="line"><span class="lineno">  348</span>    }</div>
<div class="line"><span class="lineno">  349</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  350</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8cpp_source.html#l00315">HandleWrite()</a>, <a class="el" href="network_8h_source.html#l00160">write_mutex_</a>, and <a class="el" href="network_8h_source.html#l00159">write_queue_</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00430">HandleAuthMessage()</a>, <a class="el" href="network_8cpp_source.html#l00394">HandleConnectMessage()</a>, <a class="el" href="network_8cpp_source.html#l00531">HandleKeyExchangeMessage()</a>, <a class="el" href="network_8cpp_source.html#l00472">HandleQueryMessage()</a>, and <a class="el" href="network_8cpp_source.html#l00551">SendErrorMessage()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a209a0ecc167cb5aae86820fea9bd4ebf" name="a209a0ecc167cb5aae86820fea9bd4ebf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a209a0ecc167cb5aae86820fea9bd4ebf">&#9670;&#160;</a></span>closed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool sqlcc::network::ConnectionHandler::closed_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00158">158</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00352">Close()</a>, and <a class="el" href="network_8cpp_source.html#l00276">IsClosed()</a>.</p>

</div>
</div>
<a id="a0c0ac8837ca47b8333ba05ed8be19d2d" name="a0c0ac8837ca47b8333ba05ed8be19d2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c0ac8837ca47b8333ba05ed8be19d2d">&#9670;&#160;</a></span>fd_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int sqlcc::network::ConnectionHandler::fd_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00154">154</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00352">Close()</a>, <a class="el" href="network_8cpp_source.html#l00258">ConnectionHandler()</a>, <a class="el" href="network_8cpp_source.html#l00272">GetFd()</a>, <a class="el" href="network_8cpp_source.html#l00294">HandleRead()</a>, and <a class="el" href="network_8cpp_source.html#l00315">HandleWrite()</a>.</p>

</div>
</div>
<a id="abba44ef826548143ee0a2bc1d7154966" name="abba44ef826548143ee0a2bc1d7154966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba44ef826548143ee0a2bc1d7154966">&#9670;&#160;</a></span>session_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classsqlcc_1_1network_1_1Session.html">Session</a>&gt; sqlcc::network::ConnectionHandler::session_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00157">157</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00430">HandleAuthMessage()</a>, <a class="el" href="network_8cpp_source.html#l00394">HandleConnectMessage()</a>, and <a class="el" href="network_8cpp_source.html#l00472">HandleQueryMessage()</a>.</p>

</div>
</div>
<a id="a4bc9f57768bd31487fd70a93433fed8f" name="a4bc9f57768bd31487fd70a93433fed8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bc9f57768bd31487fd70a93433fed8f">&#9670;&#160;</a></span>session_manager_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classsqlcc_1_1network_1_1SessionManager.html">SessionManager</a>&gt; sqlcc::network::ConnectionHandler::session_manager_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00155">155</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00430">HandleAuthMessage()</a>, and <a class="el" href="network_8cpp_source.html#l00394">HandleConnectMessage()</a>.</p>

</div>
</div>
<a id="aafbcdfdd4ef0d522ee4cfe698f473ac1" name="aafbcdfdd4ef0d522ee4cfe698f473ac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafbcdfdd4ef0d522ee4cfe698f473ac1">&#9670;&#160;</a></span>sql_executor_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classsqlcc_1_1SqlExecutor.html">sqlcc::SqlExecutor</a>&gt; sqlcc::network::ConnectionHandler::sql_executor_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00156">156</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00472">HandleQueryMessage()</a>.</p>

</div>
</div>
<a id="a34319e10eba112051220f8747e53dd34" name="a34319e10eba112051220f8747e53dd34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34319e10eba112051220f8747e53dd34">&#9670;&#160;</a></span>write_mutex_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex sqlcc::network::ConnectionHandler::write_mutex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00160">160</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00315">HandleWrite()</a>, and <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>.</p>

</div>
</div>
<a id="a3f467ddb730965d1a663242bd6a1e17a" name="a3f467ddb730965d1a663242bd6a1e17a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f467ddb730965d1a663242bd6a1e17a">&#9670;&#160;</a></span>write_queue_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::queue&lt;std::vector&lt;char&gt; &gt; sqlcc::network::ConnectionHandler::write_queue_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00159">159</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00315">HandleWrite()</a>, and <a class="el" href="network_8cpp_source.html#l00340">SendMessage()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/network/<a class="el" href="network_8h_source.html">network.h</a></li>
<li>src/network/<a class="el" href="network_8cpp_source.html">network.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesqlcc.html">sqlcc</a></li><li class="navelem"><a class="el" href="namespacesqlcc_1_1network.html">network</a></li><li class="navelem"><a class="el" href="classsqlcc_1_1network_1_1ConnectionHandler.html">ConnectionHandler</a></li>
    <li class="footer">Generated on Wed Nov 26 2025 00:11:12 for SQLCC by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
