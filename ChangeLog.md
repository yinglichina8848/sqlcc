# 变更日志 (Change Log)

所有重要的项目变更都会记录在这个文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)，
并且该项目遵循 [语义化版本控制](https://semver.org/lang/zh-CN/)。

---

## [未发布] (Unreleased)

### 计划中的功能
- B+树索引结构
- SQL解析器基础框架
- 事务管理系统
- 并发控制机制

---

## [0.2.5] - 2025-11-07

### 新增
- **代码覆盖率测试支持**：添加了完整的代码覆盖率测试功能
- **覆盖率报告生成**：支持生成HTML格式的详细代码覆盖率报告
- **构建系统增强**：在CMakeLists.txt中添加了ENABLE_COVERAGE选项和相关编译标志
- **Makefile增强**：添加了coverage目标，支持一键生成覆盖率报告
- **依赖管理**：更新install-deps目标，添加lcov依赖
- **清理功能**：更新clean-all目标，清理覆盖率报告文件

#### 详细变更
- 在CMakeLists.txt中添加了ENABLE_COVERAGE选项，默认为OFF
- 当启用覆盖率时，添加-fprofile-arcs和-ftest-coverage编译选项
- 添加--coverage链接选项，确保覆盖率数据正确收集
- 在Makefile中添加了coverage目标，支持生成HTML格式的覆盖率报告
- 使用lcov命令生成覆盖率数据，并使用genhtml生成HTML报告
- 添加了路径过滤，排除第三方库和测试文件的覆盖率统计
- 更新了help信息，添加coverage命令说明

#### 测试结果
- 整体行覆盖率：75.1%
- 整体函数覆盖率：90.7%
- src目录行覆盖率：70.0%
- include目录行覆盖率：71.9%
- tests目录覆盖率：100%

#### 文件覆盖率详情
- buffer_pool.cc：行覆盖率72.7%，函数覆盖率100%
- disk_manager.cc：行覆盖率55.8%，函数覆盖率83.3%
- page.cc：行覆盖率63.3%，函数覆盖率80.0%
- storage_engine.cc：行覆盖率91.8%，函数覆盖率100%

#### 改进建议
- 为disk_manager.cc添加文件打开失败等错误处理测试
- 为page.cc补充未覆盖函数测试
- 为buffer_pool.cc增加缓冲池满等场景测试

---

## [0.2.4] - 2025-11-07

### 新增
- 更新所有文档，将版本号统一升级到0.2.4
- 添加当前日期和时间标记到文档中
- 完善文档间的引用关系，确保一致性

### 改进
- 优化文档结构，提高可读性
- 确保所有文档版本信息同步

### 文档
- 更新ChangeLog.md，记录最新版本变更
- 更新README.md中的版本状态
- 更新Guide.md中的版本信息
- 更新docs/index.md中的文档说明

---

## [0.2.3] - 2025-06-18

### 新增
- 完善存储引擎设计文档，增加设计思想(Why-What-How)分析
- 添加设计优劣评估、资源有限情况下的设计取舍分析
- 增加软件工程设计思想总结，包括自顶向下分解与设计指标权衡
- 添加教学价值和学习建议，帮助学生理解实际项目中的概念应用
- 为所有核心组件添加详细的Doxygen注释，采用Why-What-How格式

### 改进
- 更新storage_engine_design.md文档，增强对软件工程设计思想和权衡过程的阐述
- 完善页面生命周期、并发控制、错误处理、测试策略等章节
- 优化文档结构，使其更适合教学和学习使用

### 文档
- 同步更新所有MD文件，确保引用内容自洽
- 更新变更记录，包含最新设计改进内容
- 生成最新Doxygen文档，包含所有新增注释

---

## [0.2.2] - 2025-11-05 16:00:00

### 新增 (Added)
- **架构设计文档**：创建了Architecture.md，详细描述了系统六个模块的设计
- **文档体系完善**：建立了完整的文档体系，包括架构设计、文档导航和项目说明
- **针对性阅读路径**：为AI辅助编程学习者和DBMS学习者设计了专门的阅读路径
- **版本升级指南**：在Guide.md中添加了版本升级指南和AI提示词示例
- **项目版本状态**：在README.md中添加了项目版本状态和文档说明

#### 详细变更
- 创建了Architecture.md，使用Why-What-Who-How分析框架解释设计决策
- 更新了docs/index.md，添加了针对不同读者的阅读路径
- 更新了README.md，在保留原始内容的基础上添加了新版本状态和文档说明
- 在Guide.md中添加了版本升级指南、新版本AI提示词与命令、升级步骤和未来版本计划
- 建立了文档间的交叉引用和逻辑关系

#### 文档体系结构
- **Architecture.md**：系统架构设计文档，包含六个模块的功能清单和设计思路
- **docs/index.md**：文档导航中心，提供分类阅读路径
- **README.md**：项目说明，保留原始需求并添加新版本状态
- **Guide.md**：开发指南，包含版本升级指南和AI提示词示例

#### 针对不同读者的阅读路径
- **AI辅助编程学习者**：学习如何利用AI工具构建数据库系统的路径
- **DBMS学习者**：了解和使用SQLCC数据库系统的路径
- **快速体验者**：快速体验SQLCC数据库系统的简化路径

#### 版本升级指南
- 提供了从v0.1.0升级到v0.2.0的具体步骤
- 包含了文档生成、架构设计和阅读路径设计的AI提示词示例
- 每个提示词都包含了AI响应示例和评价，包括优点、缺点和改进建议

#### 未来版本计划
- v0.3.0计划特性：SQL解析器、B+树索引、CRUD操作、事务系统
- v0.4.0计划特性：查询优化器、并发控制、性能优化、工具完善

### 变更 (Changed)
- 优化了文档组织结构，提供更清晰的导航和阅读路径
- 改进了文档间的逻辑关系，确保内容一致性
- 完善了版本管理，添加了版本升级指南

---

## [0.2.1] - 2025-11-05 15:30:00

### 新增 (Added)
- **文档分支管理**：创建了专门的docs分支用于管理Doxygen生成的API文档
- **分支管理文档**：创建了docs/BRANCHES.md，详细说明主分支和文档分支的用途和使用方法
- **文档生成脚本**：创建了scripts/generate_docs.sh，简化文档生成流程
- **Makefile支持**：添加了Makefile，提供便捷的构建、测试和文档生成命令
- **文档中心**：创建了docs/index.md，作为所有文档的导航入口
- **AI交互记录**：创建了TRAE-Chat.md，记录完整的AI辅助开发过程

#### 详细变更
- 创建了docs分支，将Doxygen生成的API文档与主分支分离
- 更新了.gitignore文件，添加/docs/doxygen/规则，确保API文档不会提交到主分支
- 在README.md中添加了分支说明和API文档查看指南
- 创建了完整的文档管理体系，包括生成、组织和导航
- 实现了分支间同步机制，确保代码和文档的一致性

#### 技术实现
- 使用Git分支管理代码和文档的分离
- 使用Makefile简化常用操作
- 使用脚本自动化文档生成流程
- 使用Markdown文档提供清晰的使用指南

#### 分支结构
- **主分支 (master)**：包含源代码、测试和基础文档
- **文档分支 (docs)**：包含主分支所有内容以及完整的Doxygen API文档

### 变更 (Changed)
- 更新了README.md，添加了分支说明和API文档查看指南
- 优化了文档组织结构，提供更清晰的导航
- 改进了项目构建和文档生成流程

---

## [0.2.0] - 2025-11-05 15:07:00

### 新增 (Added)
- **存储引擎核心功能**：实现了完整的页式存储引擎系统
- **磁盘管理器 (DiskManager)**：负责磁盘I/O操作和页面空间管理
- **缓冲池 (BufferPool)**：实现页面缓存和LRU替换策略
- **页面对象 (Page)**：表示内存中的8KB数据页
- **存储引擎 (StorageEngine)**：整合所有组件，提供统一接口
- **日志系统**：使用spdlog实现分级日志记录
- **单元测试框架**：使用Google Test框架实现全面的单元测试
- **Doxygen文档**：添加了完整的API文档注释

#### 详细变更
- 实现了`DiskManager`类，支持页面分配、释放和读写操作
- 实现了`BufferPool`类，支持LRU替换策略和页面引用计数
- 实现了`Page`类，提供数据读写接口和元数据管理
- 实现了`StorageEngine`类，整合所有组件提供统一接口
- 添加了完整的单元测试，覆盖所有核心功能
- 为所有源码添加了Doxygen风格注释
- 创建了存储引擎设计文档和单元测试文档

#### 测试结果
- ✅ 所有7个单元测试通过
- ✅ 存储引擎初始化测试通过
- ✅ 新页面创建测试通过
- ✅ 页面获取测试通过
- ✅ 页面刷新测试通过
- ✅ 全量页面刷新测试通过
- ✅ 大量页面操作测试通过
- ✅ 页面删除测试通过

#### 性能指标
- 页面大小：8KB
- 缓冲池大小：可配置，默认64页
- LRU替换算法：O(1)时间复杂度
- 单元测试执行时间：< 1秒

#### 技术栈确认
- **开发语言**：C++20
- **构建工具**：CMake 3.22+
- **测试框架**：Google Test
- **日志库**：spdlog
- **文档生成**：Doxygen
- **编译器**：GCC 13.3.0
- **开发环境**：WSL + Ubuntu 24.04

### 变更 (Changed)
- 更新了项目文档，添加了存储引擎设计文档
- 完善了单元测试框架，提高了代码覆盖率
- 优化了页面删除逻辑，确保删除后FetchPage返回nullptr

### 修复 (Fixed)
- 修复了BufferPool::FetchPage方法在页面不存在时仍创建新页面的问题
- 修复了storage_engine_test.cc中的类型转换错误
- 修复了DeletePage测试失败的问题

---

## [0.1.1] - 2025-10-29

### 新增 (Added)
- **版本标签**：创建了v0.1.1标签，标记项目初始框架完成
- **文档完善**：项目文档体系建立完成

### 变更 (Changed)
- **版本号更新**：从0.1.0更新到0.1.1，表示初始框架稳定版本
- **项目状态**：从开发阶段进入可编译执行阶段

### 说明
这个版本标志着项目初始框架的完成，具备以下特征：
- ✅ 项目结构完整
- ✅ 构建系统配置完成
- ✅ 可以成功编译
- ✅ 程序可以正常执行
- ✅ 版本管理规范

---

## [0.1.0] - 2025-10-29

### 新增 (Added)
- **项目初始化**：创建了完整的C++数据库项目结构
- **构建系统**：配置了CMake构建系统，支持C++20标准
- **版本管理**：实现了语义化版本控制（Semantic Versioning）
- **基础程序框架**：创建了可执行的数据库启动程序
- **文档体系**：建立了完整的项目文档结构

#### 详细变更
- 创建了标准的项目目录结构：`src/`, `include/`, `docs/`, `tests/`, `scripts/`
- 配置了`.gitignore`文件，排除构建产物和IDE配置文件
- 实现了主程序框架，支持版本信息显示
- 创建了版本头文件`include/version.h`，定义版本号宏
- 配置了CMakeLists.txt，支持多种编译方式
- 添加了完整的编译警告选项（-Wall -Wextra -Wpedantic -Wshadow -Wconversion）

#### 编译和运行验证
- ✅ CMake配置成功，无错误提示
- ✅ 编译过程无警告和错误
- ✅ 可执行文件生成成功（build/sqlcc）
- ✅ 程序运行输出正确版本信息："SqlCC 0.1.0 startup!"
- ✅ 程序正常退出（返回码0）

#### 性能指标
- 编译时间：< 1秒
- 可执行文件大小：约 20KB
- 内存使用：正常范围
- 启动速度：瞬时响应

#### 技术栈确认
- **开发语言**：C++20
- **构建工具**：CMake 3.22+
- **编译器**：GCC 13.3.0
- **开发环境**：WSL + Ubuntu 24.04
- **版本控制**：Git + Gitee

### 变更 (Changed)
- 更新了Guide.md文档，添加了详细的编译和执行说明
- 完善了项目初始化流程，提供了多种编译方法

### 修复 (Fixed)
- 修复了CMakeLists.txt文件路径配置问题
- 解决了构建系统配置错误

---

## [0.0.1] - 2025-10-29

### 新增 (Added)
- **仓库初始化**：在Gitee上创建了项目仓库
- **基础文档**：创建了README.md和项目说明文档
- **许可证**：添加了项目许可证文件

### 标签说明
- 这是一个里程碑标签，标记项目正式开始
- 主要用于版本控制历史记录

---

## 版本历史概览

| 版本 | 发布日期 | 主要功能 | 状态 |
|------|----------|----------|------|
| 0.1.0 | 2025-10-29 | 项目初始化，基础框架 | ✅ 完成 |
| 0.2.0 | 2025-11-05 15:07:00 | 存储引擎核心功能 | ✅ 完成 |
| 0.2.1 | 2025-11-05 15:30:00 | 文档分支管理系统 | ✅ 完成 |
| 0.3.0 | 计划中 | SQL解析器实现 | 📋 计划中 |
| 0.4.0 | 计划中 | B+树索引系统 | 📋 计划中 |
| 0.5.0 | 计划中 | 事务管理功能 | 📋 计划中 |
| 1.0.0 | 目标 | 完整数据库系统 | 🎯 最终目标 |

---

## 贡献指南

### 提交信息规范
遵循[约定式提交](https://www.conventionalcommits.org/zh-hans/v1.0.0/)规范：

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

类型说明：
- `feat`: 新功能
- `fix`: 修复问题
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `test`: 测试相关
- `chore`: 构建过程或辅助工具的变动

### 版本发布流程
1. 更新`include/version.h`中的版本号
2. 更新`ChangeLog.md`文件
3. 创建Git标签：`git tag -a v0.x.x -m "版本说明"`
4. 推送标签：`git push origin v0.x.x`

---

**最后更新：2025年10月29日 | 维护者：yinglichina, 李莹**  
yinglichina@gmail.com, 1820393151@qq.com